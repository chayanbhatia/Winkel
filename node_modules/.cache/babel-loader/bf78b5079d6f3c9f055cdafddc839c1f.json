{"ast":null,"code":"import jwt from 'jsonwebtoken';\nimport firebase from './Firebase';\nexport const GoogleSignIn = async () => {\n  var provider = new firebase.auth.GoogleAuthProvider();\n  return firebase.auth().signInWithPopup(provider).then(result => {\n    const db = firebase.firestore();\n\n    if (result.additionalUserInfo.isNewUser) {\n      db.collection('users').doc(result.user.uid).set({\n        name: result.user.displayName,\n        email: result.user.email,\n        uid: result.user.uid,\n        cart: []\n      }, {\n        merge: true\n      });\n    } else {\n      db.collection('users').doc(result.user.uid).set({\n        name: result.user.displayName,\n        email: result.user.email,\n        uid: result.user.uid\n      }, {\n        merge: true\n      });\n    }\n\n    const cart = db.collection('users').doc(result.user.uid).get().then(data => {\n      const cart = data.data().cart;\n      return cart;\n    });\n    const resultData = {\n      name: result.user.displayName,\n      email: result.user.email,\n      uid: result.user.uid,\n      cart\n    };\n    const Token = jwt.sign(resultData, process.env.REACT_APP_SECURE_TOKEN_ACCESS_KEY);\n    localStorage.setItem('authToken', Token);\n    return {\n      result,\n      cart\n    };\n  }).catch(error => {\n    return error;\n  });\n};\nexport const FacebookSignIn = async () => {\n  var provider = new firebase.auth.FacebookAuthProvider();\n  return firebase.auth().signInWithPopup(provider).then(result => {\n    const db = firebase.firestore();\n    db.collection('users').doc(result.user.uid).set({\n      name: result.user.displayName,\n      email: result.user.email,\n      uid: result.user.uid\n    }, {\n      merge: true\n    });\n    const resultData = {\n      name: result.user.displayName,\n      email: result.user.email,\n      uid: result.user.uid\n    };\n    console.log(resultData);\n    const Token = jwt.sign(resultData, process.env.REACT_APP_SECURE_TOKEN_ACCESS_KEY);\n    localStorage.setItem('authToken', Token);\n    return result;\n  }).catch(error => {\n    return error;\n  });\n};\nexport const logout = async () => {\n  localStorage.removeItem('authToken');\n  return firebase.auth().signOut().then(() => {\n    return \"Success\";\n  }).catch(() => {\n    return \"Error\";\n  });\n};\nexport async function verifySecuredToken(token) {\n  return jwt.verify(token, process.env.NEXT_PUBLIC_SECURE_TOKEN_ACCESS_KEY, (err, userData) => {\n    if (err) return null;\n    if (userData.name === (null || undefined) || userData.email === (null || undefined) || userData.uid === (null || undefined)) return null;\n    return userData;\n  });\n}","map":{"version":3,"sources":["/Users/alizahir/Documents/Programming/Web Development /Personal-projects/Winkel-eCommerce/winkel/src/config/FirebaseAuth.js"],"names":["jwt","firebase","GoogleSignIn","provider","auth","GoogleAuthProvider","signInWithPopup","then","result","db","firestore","additionalUserInfo","isNewUser","collection","doc","user","uid","set","name","displayName","email","cart","merge","get","data","resultData","Token","sign","process","env","REACT_APP_SECURE_TOKEN_ACCESS_KEY","localStorage","setItem","catch","error","FacebookSignIn","FacebookAuthProvider","console","log","logout","removeItem","signOut","verifySecuredToken","token","verify","NEXT_PUBLIC_SECURE_TOKEN_ACCESS_KEY","err","userData","undefined"],"mappings":"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","sourcesContent":["import jwt from 'jsonwebtoken'\nimport firebase from './Firebase'\n\nexport const GoogleSignIn = async () => {\n\n    var provider = new firebase.auth.GoogleAuthProvider();\n    return firebase.auth().signInWithPopup(provider)\n        .then((result) => {\n            const db = firebase.firestore();\n            if (result.additionalUserInfo.isNewUser) {\n                db.collection('users').doc(result.user.uid).set({\n                    name: result.user.displayName,\n                    email: result.user.email,\n                    uid: result.user.uid,\n                    cart: []\n                }, { merge: true });\n            } else {\n                db.collection('users').doc(result.user.uid).set({\n                    name: result.user.displayName,\n                    email: result.user.email,\n                    uid: result.user.uid\n                }, { merge: true });\n            }\n            const cart = db.collection('users').doc(result.user.uid).get().then(data => {\n                const cart = data.data().cart;\n                return cart;\n            })\n            const resultData = {\n                name: result.user.displayName,\n                email: result.user.email,\n                uid: result.user.uid,\n                cart\n            };\n            const Token = jwt.sign(resultData, process.env.REACT_APP_SECURE_TOKEN_ACCESS_KEY);\n            localStorage.setItem('authToken', Token);\n            return { result, cart };\n        })\n        .catch((error) => {\n            return error;\n        })\n\n}\nexport const FacebookSignIn = async () => {\n\n    var provider = new firebase.auth.FacebookAuthProvider();\n    return firebase.auth().signInWithPopup(provider)\n        .then((result) => {\n            const db = firebase.firestore();\n            db.collection('users').doc(result.user.uid).set({\n                name: result.user.displayName,\n                email: result.user.email,\n                uid: result.user.uid\n            }, { merge: true });\n            const resultData = {\n                name: result.user.displayName,\n                email: result.user.email,\n                uid: result.user.uid\n            };\n            console.log(resultData)\n            const Token = jwt.sign(resultData, process.env.REACT_APP_SECURE_TOKEN_ACCESS_KEY);\n            localStorage.setItem('authToken', Token);\n\n            return result;\n        })\n        .catch((error) => {\n            return error;\n        })\n\n}\n\nexport const logout = async () => {\n    localStorage.removeItem('authToken');\n    return firebase.auth().signOut().then(() => {\n        return \"Success\";\n    }).catch(() => {\n        return \"Error\"\n    });\n}\n\nexport async function verifySecuredToken(token) {\n\n    return jwt.verify(token, process.env.NEXT_PUBLIC_SECURE_TOKEN_ACCESS_KEY, (err, userData) => {\n\n        if (err)\n            return null;\n        if (userData.name === (null || undefined) || userData.email === (null || undefined) || userData.uid === (null || undefined))\n            return null;\n        return userData;\n    });\n}"]},"metadata":{},"sourceType":"module"}